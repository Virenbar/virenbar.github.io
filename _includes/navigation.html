{%- assign tpages = site.posts | where:'slug', page.slug | sort: 'lang' -%}
{%- if tpages.size == 0 -%}
    {%- assign tpages = site.pages | where:'id', page.id | sort: 'lang' -%}
{%- endif -%}
{%- comment -%}
{%- assign debug = site.data.navigation | inspect-%}
{%- endcomment -%}
<header class="navbar navbar-expand-lg navbar-dark bg-dark px-3 sticky-top">
    <nav class="container">
        <a class="navbar-brand mx-auto" href="{{page.langurl}}/">
            <img
                alt=""
                class="d-inline-block align-top rounded-circle"
                height="32"
                src="https://gravatar.com/avatar/e405f42d63f70e88dec627087aec4318"
                width="32"/> {% include gradient.html text=site.title %}
        </a>
        <button
            aria-controls="global-navbar"
            aria-expanded="false"
            aria-label="Toggle navigation"
            class="navbar-toggler"
            data-bs-target="#global-navbar"
            data-bs-toggle="collapse"
            type="button">
            <i class="bi bi-three-dots"></i>
        </button>

        <div class="collapse navbar-collapse" id="global-navbar">
            <ul class="navbar-nav me-auto">
                {%- for navpage in site.data.navigation -%}
                    {%- assign class = "nav-item" -%}
                    {%- assign url = page.langurl | append: navpage.url -%}
                    {%- if url == page.url -%}
                        {%- assign class = class | append: " current" -%}
                        {%- assign sr_current = '<span class="sr-only">(current)</span>' -%}
                    {%- endif -%}
                    <li class="{{class}}">
                        <a class="nav-link" href="{{url}}">
                            {% include t.html id=navpage.title %}{{sr_current}}
                            {%- if navpage.url contains "http" %}
                                <span class="fas fa-external-link"></span>
                            {%- endif -%}
                        </a>
                    </li>
                {%- endfor -%}
            </ul>
            <div class="dropdown">
                <button aria-expanded="false" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
                    <i class="fa-solid fa-globe"></i>
                    {% include t.html id="lang" %}
                </button>
                <ul class="dropdown-menu dropdown-menu-dark" style="width:100%; min-width: 100%;">
                    {%- for tpage in tpages -%}
                        {%- assign class = "dropdown-item {{tpage.lang}}" -%}
                        {%- if tpage.lang == page.lang -%}
                            {%- assign class = class | append: " active" -%}
                        {%- endif -%}
                        <li>
                            <a class="{{class}}" href="{{tpage.url}}">
                                {%- include t.html id="lang" lang=tpage.lang -%}
                            </a>
                        </li>
                    {%- endfor -%}
                </ul>
            </div>
        </div>
    </nav>
</header>